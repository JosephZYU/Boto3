ğŸ§­ Rules for unit testing:

# Good morning from local repo in Desktop

    â€¢ Must be fast âš¡in running / execution (fake the API call)
    
    â€¢ Should NOT actually create anything (should be running over and over again without AWS Bills Costs)
    
    â€¢ Ideally covers ALL lines of code 

    ğŸ¤
    
    importÂ boto3
    #Â ForÂ testingÂ ONLY
    #Â DRYRUNÂ =Â True
    #Â ğŸ¯Â SetÂ GLOBALÂ variableÂ DRYRUNÂ toÂ FalseÂ toÂ runÂ itÂ forÂ real
    #Â ONLYÂ withÂ FalseÂ ifÂ youÂ pre-testÂ withÂ DRYRUNÂ =Â True
    DRYRUNÂ =Â False
    
    #Â RapÂ theÂ commandÂ intoÂ aÂ function:Â Get_Image
    
    defÂ Get_Image(ec2_client):
    Â Â Â Â imagesÂ =Â ec2_client.describe_images(
    Â Â Â Â Â Â Â Â Filters=[
    Â Â Â Â Â Â Â Â Â Â Â Â {
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 'Name':Â 'name',
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 'Values':Â [
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 'amzn2-ami-hvm*',
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ]
    Â Â Â Â Â Â Â Â Â Â Â Â },
    Â Â Â Â Â Â Â Â Â Â Â Â {
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 'Name':Â 'owner-alias',
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 'Values':Â [
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 'amazon',
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ]
    Â Â Â Â Â Â Â Â Â Â Â Â },
    Â Â Â Â Â Â Â Â ],
    Â Â Â Â )
    Â Â Â Â #Â CreateÂ aÂ resourceÂ first
    Â Â Â Â ec2_imageÂ =Â boto3.resource('ec2')
    Â Â Â Â #Â AssignÂ AMIÂ withÂ ImageÂ ID
    Â Â Â Â #Â Recall:Â imageIdÂ =Â images['Images'][0]['ImageId']
    Â Â Â Â AMIÂ =Â ec2_image.Image(images['Images'][0]['ImageId'])
    Â Â Â Â returnÂ AMI
    #Â RapÂ theÂ commandÂ intoÂ aÂ function:Â Start_Ec2
    #Â PlaceÂ requiredÂ parameterÂ intoÂ theÂ def()
    
    defÂ Start_Ec2(AMI,Â ec2_client):
    Â Â Â Â ifÂ AMI.stateÂ ==Â 'available':
    Â Â Â Â Â Â Â Â #Â LeverageÂ theÂ AMIÂ attributes
    Â Â Â Â Â Â Â Â print(AMI.image_id)
    Â Â Â Â Â Â Â Â instanceÂ =Â ec2_client.run_instances(
    Â Â Â Â Â Â Â Â Â Â Â Â #Â ImageId='ami-0947d2ba12ee1ff75',Â #Â ThisÂ isÂ NOTÂ aÂ goodÂ practiceÂ toÂ putÂ staticÂ IDÂ (expiration)
    Â Â Â Â Â Â Â Â Â Â Â Â ImageId=AMI.image_id,
    Â Â Â Â Â Â Â Â Â Â Â Â InstanceType='t2.micro',
    Â Â Â Â Â Â Â Â Â Â Â Â MaxCount=1,
    Â Â Â Â Â Â Â Â Â Â Â Â MinCount=1,
    Â Â Â Â Â Â Â Â Â Â Â Â DryRun=DRYRUNÂ Â #Â fromÂ ourÂ GLOBALÂ variable
    Â Â Â Â Â Â Â Â )
    Â Â Â Â Â Â Â Â #Â CreateÂ Boto3Â resourcesÂ forÂ EC2
    Â Â Â Â Â Â Â Â ec2_instanceÂ =Â boto3.resource('ec2')
    Â Â Â Â Â Â Â Â #Â ğŸ¯Â AssignÂ instanceÂ withÂ instanceÂ IDÂ toÂ talkÂ to
    Â Â Â Â Â Â Â Â #Â ThisÂ willÂ pullÂ theÂ InstanceIdÂ fromÂ theÂ aboveÂ run_instances()Â command
    Â Â Â Â Â Â Â Â ec2Â =Â ec2_instance.Instance(instance['Instances'][0]['InstanceId'])
    Â Â Â Â Â Â Â Â returnÂ ec2
    Â Â Â Â else:
    Â Â Â Â Â Â Â Â print('YourÂ chosenÂ AMIÂ isÂ NOTÂ available.')
    Â Â Â Â Â Â Â Â #Â returnÂ NoneÂ -Â indicateÂ itÂ didn'tÂ workÂ succseefully
    Â Â Â Â Â Â Â Â returnÂ False
    
    #Â ğŸ¯Â RefactorÂ scripsÂ intoÂ thisÂ formatÂ isÂ greatÂ forÂ UnitÂ TestingÂ andÂ supportÂ forÂ theÂ longÂ term
    #Â ğŸ˜Â LeaveÂ theÂ deatiledÂ logicÂ ONLYÂ withinÂ yourÂ functions
    #Â IfÂ thisÂ ec2.pyÂ scriptÂ isÂ calledÂ onÂ itsÂ own,Â thenÂ runÂ throughÂ theÂ followingÂ code
    ifÂ __name__Â ==Â '__main__':
    Â Â Â Â ec2_clientÂ =Â boto3.client('ec2')
    Â Â Â Â #Â ğŸ¯Â ApplyÂ theÂ defÂ functionsÂ above
    Â Â Â Â AMIÂ =Â Get_Image(ec2_client)
    Â Â Â Â ec2Â =Â Start_Ec2(AMI=AMI,Â ec2_client=ec2_client)
    Â Â Â Â print(ec2.instance_id)
    Â Â Â Â #Â WaitÂ andÂ makeÂ sureÂ untilÂ EC2Â instanceÂ isÂ running
    Â Â Â Â ec2.wait_until_running()
    Â Â Â Â print(f"InstanceÂ isÂ {ec2.state['Name']}")
    Â Â Â Â #Â TriggerÂ theÂ termination
    Â Â Â Â ec2.terminate()
    Â Â Â Â ec2.wait_until_terminated()
    Â Â Â Â print(f"InstanceÂ isÂ {ec2.state['Name']}")
    
    
Reference from Boto3 Documentation:

    
    ğŸ“ https://boto3.amazonaws.com/v1/documentation/api/1.9.42/reference/services/ec2.html#EC2.Client.describe_images
    
    ğŸ¤ Response Syntax:
    
    {
        'Images': [
            {
                'Architecture': 'i386'|'x86_64',
                'CreationDate': 'string',
                'ImageId': 'string',
                'ImageLocation': 'string',
                'ImageType': 'machine'|'kernel'|'ramdisk',
                'Public': True|False,
                'KernelId': 'string',
                'OwnerId': 'string',
                'Platform': 'Windows',
                'ProductCodes': [
                    {
                        'ProductCodeId': 'string',
                        'ProductCodeType': 'devpay'|'marketplace'
                    },
                ],
                'RamdiskId': 'string',
                'State': 'pending'|'available'|'invalid'|'deregistered'|'transient'|'failed'|'error',
                'BlockDeviceMappings': [
                    {
                        'DeviceName': 'string',
                        'VirtualName': 'string',
                        'Ebs': {
                            'DeleteOnTermination': True|False,
                            'Iops': 123,
                            'SnapshotId': 'string',
                            'VolumeSize': 123,
                            'VolumeType': 'standard'|'io1'|'gp2'|'sc1'|'st1',
                            'Encrypted': True|False,
                            'KmsKeyId': 'string'
                        },
                        'NoDevice': 'string'
                    },
                ],
                'Description': 'string',
                'EnaSupport': True|False,
                'Hypervisor': 'ovm'|'xen',
                'ImageOwnerAlias': 'string',
                'Name': 'string',
                'RootDeviceName': 'string',
                'RootDeviceType': 'ebs'|'instance-store',
                'SriovNetSupport': 'string',
                'StateReason': {
                    'Code': 'string',
                    'Message': 'string'
                },
                'Tags': [
                    {
                        'Key': 'string',
                        'Value': 'string'
                    },
                ],
                'VirtualizationType': 'hvm'|'paravirtual'
            },
        ]
    }
    
    
Open and Edit requirement file:

    ğŸ’² vi requirements.txt
    
    # Add pytest
    
    
    
    ğŸ’² pip install -r requirements.txt
    
    # Use Pytest to run Unit Test file (test_ec2.py)
    ğŸ’² pytest test_ec2.py
